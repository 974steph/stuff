<!DOCTYPE html>
<html>
<head>
<style title="mainPage">
	body {background-color: #352879;}
	h1   {color: blue;}

	#controls {
		margin: 2px 0;
		border:2px solid black;
		vertical-align:top;
		color: #6C5EB5;
		position:absolute; top:5px; left:82%;
		font-size: 20px;
		font-weight:  bold;
    font-family: "Lucida Console", Monaco, monospace;
	}

	section {
		text-align: center;
		margin: 2px 0;
		border: 2px solid #000;
		width: 80%;
	}

	.parent {
		border: 0px solid #f00;
		height: 600px;
	}

	.parent .panzoom { 
		border: 0px dashed #0f0;
		position: relative;
		transform-origin: 000 000 !important;
                transform: scale(0.22) translate(-280px, -300px);
	}

	.parent .overlay {
		position: absolute;
		z-index: 1;
		border: 0px dashed #0f0; 
		top: 0;
		left: 0;
	}

	.buttons {
		margin: 10px 0px 0;
		position: absolute;
		z-index: 10;
		top: 0px;
		left: 180px;
	}


	object {
		pointer-events:none;
	}
</style>
<script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script src="/js/plugins/jquery.panzoom.min.js"></script>
<script src="c64hw.js"></script>
</head>


<body onload="init_c64()">

<script>


function NOT_sigchange(id, checked){
//	alert ("got id: " + id + " checked: " + checked );

	var svgDoc = svgObject.contentDocument;
	var styleElement = svgDoc.getElementById(id);
	if ( typeof styleElement === 'undefined' || styleElement === null) {
//		console.log(id + ' not defined');
		styleElement = svgDoc.createElementNS("http://www.w3.org/2000/svg", "style");
		svgDoc.getElementById("myStyle").appendChild(styleElement);
	} else {
//		console.log(id + ' defined');
//		console.log(id + ' textContent: ' + styleElement.textContent);
	}

	if ( id.match(/^\.U\d+\w?$/) ) {	// U digits single letter
		if (checked == true) {
			var fill = "fill: #F2F;";
			var opacity = "fill-opacity:0.27;";
			styleElement.id = id;
			styleElement.textContent = id + " { " + fill + opacity + "}"; // add whatever you need here
		} else {
			var fill = "fill: #F2F;";
			var opacity = "fill-opacity:0.00;";
			styleElement.id = id;
			styleElement.textContent = id + " { " + fill + opacity + "}"; // add whatever you need here
		}
	} else {
		if (checked == -1) {
			var colour = "stroke: none;";
			var width = "stroke-width:5;";
			styleElement.id = id;
			styleElement.textContent = id + " { " + colour + width + "}"; // add whatever you need here
		}
		if (checked == 0) {
			var colour = "stroke: #282;";
			var width = "stroke-width:10;";
			styleElement.id = id;
			styleElement.textContent = id + " { " + colour + width + "}"; // add whatever you need here
		}
		if (checked == 1) {
			var colour = "stroke: #D55;";
			var width = "stroke-width:7;";
			styleElement.id = id;
			styleElement.textContent = id + " { " + colour + width + "}"; // add whatever you need here
		}
	}

	svgDoc.getElementById("myStyle").appendChild(styleElement);

}

</script>

    <section id="focal">

	<div class="parent">

		<div class="panzoom">
<!--
			<img src="326106-2of2.gif" height="3296" width="4496">
-->
			<div class="overlay">
				<object id=svgObject height="3296" width="4496" type="image/svg+xml" data="326106-2of2.svg"></object>    

			</div>
		</div>
	</div>

	<div class="buttons">
		<button class="zoom-out">Zoom Out</button>
		<input type="range" class="zoom-range" min="0.1", max="1.0" step="0.1" value="0.1">
		<button class="zoom-in">Zoom In</button>
		<button class="reset">Reset</button>
	</div>

      <script>
        (function() {
          var $section = $('#focal');
          $section.find('.panzoom').panzoom({
		$zoomIn: $section.find(".zoom-in"),
		$zoomOut: $section.find(".zoom-out"),
		$zoomRange: $section.find(".zoom-range"),
		$reset: $section.find(".reset"),

//		startTransform: 'scale(0.18)',
		contain: false,
		increment: 0.05,
		minScale: 0.1,
		maxScale: 1.0,
          });
        })();

        (function() {
          var $section = $('#focal');
          var $panzoom = $section.find('.panzoom').panzoom();
          $panzoom.parent().on('mousewheel.focal', function( e ) {
            e.preventDefault();
            var delta = e.delta || e.originalEvent.wheelDelta;
            var zoomOut = delta ? delta < 0 : e.originalEvent.deltaY > 0;
            $panzoom.panzoom('zoom', zoomOut, {
              increment: 0.1,
              animate: false,
              focal: e
            });
          });
        })();



		function blah() {
//			alert ("hi there");
			var $section = $('#focal');
			var $panzoom = $section.find('.panzoom').panzoom();
			$panzoom.panzoom("pan", 0,0);
			$panzoom.panzoom("zoom", 0.18, { silent: true } );
		}

      </script>
    </section>


<div id="controls">
Set signals
<!--
<br><input type="checkbox" id=".nDMA" onchange='sigchange(this.id, this.checked)'>/DMA
<br><input type="checkbox" id=".BA" onchange='sigchange(this.id, this.checked)'>BA


<br><input type="checkbox" id=".nRES" onchange='sigchange(this.id, this.checked)'>/RES 


<br><input type="checkbox" id=".nCHAREN" onchange='sigchange(this.id, this.checked)'>nCHAREN
<br><input type="checkbox" id=".nCHAROM" onchange='sigchange(this.id, this.checked)'>nCHAROM
-->

<br><input type="checkbox" name="nHIRAM" id=".nHIRAM" onchange='set_signal(this.id, this.checked)'>nHIRAM
<br><input type="checkbox" name="nLORAM" id=".nLORAM" onchange='set_signal(this.id, this.checked)'>nLORAM
<br><input type="checkbox" name="nCHAREN" id=".nCHAREN" onchange='set_signal(this.id, this.checked)'>nCHAREN

<br><input type="checkbox" name="RW" id=".RW" onchange='set_signal(this.id, this.checked)'>RW
<br><input type="checkbox" name="nVA14" id=".nVA14" onchange='set_signal(this.id, this.checked)'>/VA14 
<br><input type="checkbox" name="nVA15" id=".nVA15" onchange='set_signal(this.id, this.checked)'>/VA15

<!--
<br><input type="checkbox" id=".D8" onchange='sigchange(this.id, this.checked)'>D8
<br><input type="checkbox" id=".D0" onchange='sigchange(this.id, this.checked)'>D0
<br><input type="checkbox" id=".st0" onchange='sigchange(this.id, this.checked)'>st0
<br><input type="checkbox" id=".st1" onchange='sigchange(this.id, this.checked)'>st1

<br><input type="checkbox" id=".U19" onchange='sigchange(this.id, this.checked)'>U19
-->


<br><input type="textbox" size="2" id="master_clock">
<input type="button" id="step" value="step" onclick='step_simulation()'>
<br>
<input type="button" id="stop" value="stop" onclick='stop()'>
<input type="button" id="play" value="play" onclick='play()'>
<br><input type="textbox" size="5" id="CPU_ADDRESS" onchange='set_addr(this.id)'>CPU Addr
<br><input type="textbox" size="5" id="VIC_ADDRESS" onchange='set_addr(this.id)'>VIC Addr


<!--
<br><input type="button" id="blah" onclick='blah()'>reset zoom 
-->
</div>


</body>
</html>


